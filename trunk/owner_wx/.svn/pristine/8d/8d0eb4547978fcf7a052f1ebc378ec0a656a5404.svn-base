import { Component,OnInit } from '@angular/core';
import { RouterModule,ActivatedRoute, Router } from '@angular/router';
import {goodsReceiptService } from './goodsReceipt.service'
import { ValidateMessage } from  '../fragment/validateMessage';
import { Title } from '@angular/platform-browser';

declare var mui: any;


@Component({
  selector: 'app-GoodsReceipt',
  templateUrl: './goodsReceipt.component.html',
  styleUrls: ['./goodsReceipt.component.css'],
  providers:[goodsReceiptService]
})

export class GoodsReceipt implements OnInit{
  market_title="我的收货";
  public infos:any;
  public pageSize;
  public data;
  public isLoading:boolean;//是否显示加载
  public page:number;
  public isShow:boolean;
  
  constructor(
    public router: Router,
    public service:goodsReceiptService,
    public titleService: Title,
  ){}
 //货源信息
  goodsDetails(childNo){
   
    this.router.navigateByUrl("goodsReceipt/ReceiptDetails/"+childNo);
  }
//呼叫司机
call(){
  console.log(this.data.driverPhone)
  mui.confirm("呼叫司机：" + this.data.driverName, " ", 
  new Array('取消', '<a href="tel:this.data.driverPhone" style="color:#ea5529">呼叫</a>'), function (e) {})
}
skip(childNo){
  this.router.navigateByUrl("confirmGoods?childNo="+childNo);
}
  ngOnInit(): void{
    this.titleService.setTitle('我的收货');
    this.page=1;
    this.pageSize=5;
    this.isShow=false;
    this.isLoading=false;
    mui('.mui-scroll-wrapper').scroll({
      deceleration: 0.0005 //flick 减速系数，系数越大，滚动速度越慢，滚动距离越小，默认值0.0006
    });

    //查询货源列表
    this.service.getOrderChildListBySendId(this.page,this.pageSize)
        .subscribe(data=>{
          if(data.code==0){//成功        
              this.infos=data.data;
              console.log(data);
        }
          this.page=this.page+1;
        });
  }
    //点击加载更多
  moreInfo(){
    this.isLoading=true;
    //查询货源列表
    this.service.getOrderChildListBySendId(this.page,this.pageSize)
        .subscribe(data=>{
          if(data.code==0){//成功
            this.isLoading=false;
            for(var i=0;i<data.data.length;i++){
              this.infos.push(data.data[i]);
            }
          }
          this.page=this.page+1;
        });
  }
}
